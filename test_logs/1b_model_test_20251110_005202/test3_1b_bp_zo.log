Using device: cuda
Logs will be stored in /home/polyu/pcllzy/zo_withbp/logs/test3_1b_bp_zo_20251110_005206
成功从本地加载tokenizer: /home/polyu/pcllzy/zo_withbp/tokenizer
Creating model: 1B
Description: 大型模型，约1B参数，需要较大显存
Configuration:
  - Embedding dim: 1536
  - Layers: 24
  - Attention heads: 24
  - Max position: 1024
  - Vocab size: 50258

Model created successfully!
Total parameters: 758,728,704 (758.73M)
Trainable parameters: 758,728,704 (758.73M)
Loading dataset: dclm-pubmedqa-merged
Description: DCLM和PubMedQA合并数据集，共20,000条，已统一为text字段
Loading local dataset from: /home/polyu/pcllzy/zo_withbp/datasets_subset/dclm_pubmedqa_merged
Tokenizing dataset...
Reading dataset:   0%|          | 0/20 [00:00<?, ?it/s]Reading dataset: 87it [00:00, 830.93it/s]              Reading dataset: 171it [00:00, 654.71it/s]Reading dataset: 240it [00:00, 666.50it/s]Reading dataset: 324it [00:00, 714.74it/s]Reading dataset: 397it [00:00, 643.88it/s]Reading dataset: 463it [00:00, 626.15it/s]Reading dataset: 535it [00:00, 644.67it/s]Reading dataset: 601it [00:00, 647.29it/s]Reading dataset: 686it [00:01, 692.78it/s]Reading dataset: 756it [00:01, 646.11it/s]Reading dataset: 823it [00:01, 652.76it/s]Reading dataset: 911it [00:01, 713.30it/s]Reading dataset: 989it [00:01, 718.93it/s]Reading dataset: 1062it [00:01, 617.82it/s]Reading dataset: 1127it [00:01, 609.48it/s]Reading dataset: 1190it [00:01, 592.10it/s]Reading dataset: 1255it [00:01, 607.37it/s]Reading dataset: 1317it [00:02, 538.07it/s]Reading dataset: 1426it [00:02, 657.88it/s]Reading dataset: 1505it [00:02, 681.58it/s]Reading dataset: 1575it [00:02, 647.08it/s]Reading dataset: 1652it [00:02, 646.54it/s]Reading dataset: 1723it [00:02, 643.06it/s]Reading dataset: 1819it [00:02, 724.74it/s]Reading dataset: 1893it [00:02, 704.62it/s]Reading dataset: 1965it [00:03, 625.22it/s]Reading dataset: 2037it [00:03, 636.19it/s]Reading dataset: 2114it [00:03, 667.64it/s]Reading dataset: 2183it [00:03, 672.76it/s]Reading dataset: 2252it [00:03, 641.06it/s]Reading dataset: 2318it [00:03, 612.31it/s]Reading dataset: 2389it [00:03, 635.99it/s]Reading dataset: 2454it [00:03, 598.00it/s]Reading dataset: 2515it [00:03, 573.92it/s]Reading dataset: 2575it [00:04, 580.58it/s]Reading dataset: 2644it [00:04, 610.81it/s]Reading dataset: 2706it [00:04, 595.34it/s]Reading dataset: 2797it [00:04, 683.80it/s]Reading dataset: 2867it [00:04, 609.40it/s]Reading dataset: 2936it [00:04, 628.95it/s]Reading dataset: 3001it [00:04, 588.75it/s]Reading dataset: 3094it [00:04, 677.21it/s]Reading dataset: 3182it [00:04, 731.11it/s]Reading dataset: 3257it [00:05, 638.40it/s]Reading dataset: 3331it [00:05, 662.61it/s]Reading dataset: 3411it [00:05, 697.59it/s]Reading dataset: 3483it [00:05, 643.67it/s]Reading dataset: 3568it [00:05, 695.66it/s]Reading dataset: 3659it [00:05, 747.72it/s]Reading dataset: 3736it [00:05, 612.42it/s]Reading dataset: 3803it [00:05, 568.74it/s]Reading dataset: 3864it [00:06, 551.66it/s]Reading dataset: 3941it [00:06, 597.35it/s]Reading dataset: 4008it [00:06, 605.09it/s]Reading dataset: 4071it [00:06, 595.96it/s]Reading dataset: 4153it [00:06, 639.51it/s]Reading dataset: 4230it [00:06, 670.41it/s]Reading dataset: 4306it [00:06, 694.57it/s]Reading dataset: 4377it [00:06, 658.00it/s]Reading dataset: 4444it [00:06, 597.56it/s]Reading dataset: 4530it [00:07, 663.45it/s]Reading dataset: 4599it [00:07, 575.81it/s]Reading dataset: 4660it [00:07, 568.64it/s]Reading dataset: 4719it [00:07, 525.12it/s]Reading dataset: 4779it [00:07, 534.06it/s]Reading dataset: 4855it [00:07, 592.39it/s]Reading dataset: 4919it [00:07, 602.43it/s]Reading dataset: 4981it [00:07, 601.83it/s]Reading dataset: 5043it [00:07, 572.54it/s]Reading dataset: 5102it [00:08, 562.00it/s]Reading dataset: 5170it [00:08, 592.39it/s]Reading dataset: 5230it [00:08, 378.07it/s]Reading dataset: 5299it [00:08, 424.76it/s]Reading dataset: 5350it [00:08, 333.98it/s]Reading dataset: 5436it [00:08, 434.13it/s]Reading dataset: 5491it [00:09, 347.36it/s]Reading dataset: 5572it [00:09, 432.65it/s]Reading dataset: 5647it [00:09, 497.51it/s]Reading dataset: 5715it [00:09, 538.51it/s]Reading dataset: 5778it [00:09, 514.19it/s]Reading dataset: 5854it [00:09, 574.31it/s]Reading dataset: 5938it [00:09, 634.92it/s]Reading dataset: 6019it [00:09, 680.72it/s]Reading dataset: 6091it [00:10, 650.51it/s]Reading dataset: 6186it [00:10, 721.17it/s]Reading dataset: 6266it [00:10, 740.36it/s]Reading dataset: 6342it [00:10, 707.38it/s]Reading dataset: 6415it [00:10, 701.45it/s]Reading dataset: 6487it [00:10, 631.48it/s]Reading dataset: 6552it [00:10, 570.58it/s]Reading dataset: 6612it [00:10, 559.63it/s]Reading dataset: 6677it [00:11, 582.96it/s]Reading dataset: 6737it [00:11, 503.02it/s]Reading dataset: 6796it [00:11, 514.09it/s]Reading dataset: 6868it [00:11, 566.17it/s]Reading dataset: 6943it [00:11, 614.52it/s]Reading dataset: 7007it [00:11, 591.47it/s]Reading dataset: 7089it [00:11, 653.89it/s]Reading dataset: 7169it [00:11, 665.33it/s]Reading dataset: 7251it [00:11, 697.93it/s]Reading dataset: 7322it [00:12, 529.52it/s]Reading dataset: 7382it [00:12, 535.11it/s]Reading dataset: 7457it [00:12, 587.09it/s]Reading dataset: 7521it [00:12, 599.17it/s]Reading dataset: 7585it [00:12, 447.55it/s]Reading dataset: 7640it [00:12, 469.59it/s]Reading dataset: 7704it [00:12, 509.67it/s]Reading dataset: 7787it [00:12, 589.57it/s]Reading dataset: 7852it [00:13, 599.26it/s]Reading dataset: 7916it [00:13, 530.52it/s]Reading dataset: 7979it [00:13, 552.50it/s]Reading dataset: 8038it [00:13, 531.86it/s]Reading dataset: 8101it [00:13, 536.62it/s]Reading dataset: 8172it [00:13, 581.15it/s]Reading dataset: 8233it [00:13, 585.09it/s]Reading dataset: 8318it [00:13, 655.48it/s]Reading dataset: 8391it [00:13, 676.38it/s]Reading dataset: 8462it [00:14, 684.21it/s]Reading dataset: 8556it [00:14, 753.42it/s]Reading dataset: 8634it [00:14, 761.00it/s]Reading dataset: 8726it [00:14, 805.63it/s]Reading dataset: 8807it [00:14, 746.92it/s]Reading dataset: 8902it [00:14, 800.20it/s]Reading dataset: 8984it [00:14, 750.35it/s]Reading dataset: 9061it [00:14, 673.93it/s]Reading dataset: 9131it [00:15, 641.86it/s]Reading dataset: 9197it [00:15, 607.91it/s]Reading dataset: 9283it [00:15, 671.17it/s]Reading dataset: 9352it [00:15, 616.38it/s]Reading dataset: 9433it [00:15, 666.27it/s]Reading dataset: 9512it [00:15, 695.06it/s]Reading dataset: 9584it [00:15, 514.39it/s]Reading dataset: 9684it [00:15, 622.90it/s]Reading dataset: 9756it [00:16, 595.23it/s]Reading dataset: 9822it [00:16, 594.14it/s]Reading dataset: 9898it [00:16, 635.51it/s]Reading dataset: 9966it [00:16, 631.39it/s]Reading dataset: 10043it [00:16, 667.47it/s]Reading dataset: 10113it [00:16, 604.99it/s]Reading dataset: 10177it [00:16, 559.13it/s]Reading dataset: 10270it [00:16, 652.87it/s]Reading dataset: 10348it [00:16, 686.66it/s]Reading dataset: 10433it [00:17, 728.29it/s]Reading dataset: 10509it [00:17, 657.62it/s]Reading dataset: 10578it [00:17, 549.59it/s]Reading dataset: 10638it [00:17, 526.93it/s]Reading dataset: 10705it [00:17, 559.45it/s]Reading dataset: 10764it [00:17, 533.47it/s]Reading dataset: 10820it [00:18, 367.25it/s]Reading dataset: 10869it [00:18, 391.55it/s]Reading dataset: 10940it [00:18, 460.05it/s]Reading dataset: 10995it [00:18, 467.12it/s]Reading dataset: 11047it [00:18, 467.18it/s]Reading dataset: 11111it [00:18, 487.01it/s]Reading dataset: 11164it [00:18, 495.41it/s]Reading dataset: 11223it [00:18, 518.34it/s]Reading dataset: 11280it [00:18, 532.55it/s]Reading dataset: 11336it [00:18, 532.15it/s]Reading dataset: 11407it [00:19, 581.42it/s]Reading dataset: 11487it [00:19, 643.78it/s]Reading dataset: 11582it [00:19, 732.96it/s]Reading dataset: 11657it [00:19, 705.74it/s]Reading dataset: 11746it [00:19, 758.27it/s]Reading dataset: 11826it [00:19, 769.84it/s]Reading dataset: 11904it [00:19, 700.46it/s]Reading dataset: 11985it [00:19, 720.87it/s]Reading dataset: 12070it [00:19, 755.45it/s]Reading dataset: 12147it [00:20, 717.63it/s]Reading dataset: 12220it [00:20, 698.90it/s]Reading dataset: 12296it [00:20, 715.80it/s]Reading dataset: 12369it [00:20, 691.93it/s]Reading dataset: 12443it [00:20, 674.12it/s]Reading dataset: 12511it [00:20, 629.42it/s]Reading dataset: 12575it [00:20, 625.45it/s]Reading dataset: 12654it [00:20, 663.13it/s]Reading dataset: 12737it [00:20, 709.25it/s]Reading dataset: 12809it [00:21, 705.91it/s]Reading dataset: 12881it [00:21, 686.19it/s]Reading dataset: 12978it [00:21, 746.94it/s]Reading dataset: 13079it [00:21, 817.30it/s]Reading dataset: 13162it [00:21, 698.61it/s]Reading dataset: 13239it [00:21, 716.89it/s]Reading dataset: 13331it [00:21, 768.98it/s]Reading dataset: 13411it [00:21, 676.71it/s]Reading dataset: 13483it [00:21, 677.55it/s]Reading dataset: 13599it [00:22, 803.42it/s]Reading dataset: 13683it [00:22, 796.25it/s]Reading dataset: 13765it [00:22, 673.16it/s]Reading dataset: 13837it [00:22, 678.27it/s]Reading dataset: 13909it [00:22, 643.44it/s]Reading dataset: 13981it [00:22, 659.75it/s]Reading dataset: 14055it [00:22, 641.60it/s]Reading dataset: 14133it [00:22, 674.09it/s]Reading dataset: 14202it [00:23, 566.50it/s]Reading dataset: 14264it [00:23, 578.74it/s]Reading dataset: 14328it [00:23, 588.34it/s]Reading dataset: 14391it [00:23, 598.85it/s]Reading dataset: 14453it [00:23, 547.11it/s]Reading dataset: 14527it [00:23, 597.79it/s]Reading dataset: 14589it [00:23, 576.90it/s]Reading dataset: 14670it [00:23, 604.60it/s]Reading dataset: 14733it [00:23, 609.33it/s]Reading dataset: 14802it [00:24, 629.87it/s]Reading dataset: 14881it [00:24, 671.54it/s]Reading dataset: 14949it [00:24, 642.45it/s]Reading dataset: 15014it [00:24, 587.23it/s]Reading dataset: 15079it [00:24, 593.88it/s]Reading dataset: 15141it [00:24, 597.24it/s]Reading dataset: 15214it [00:24, 624.67it/s]Reading dataset: 15277it [00:24, 550.27it/s]Reading dataset: 15334it [00:24, 549.07it/s]Reading dataset: 15391it [00:25, 541.44it/s]Reading dataset: 15452it [00:25, 558.37it/s]Reading dataset: 15519it [00:25, 584.96it/s]Reading dataset: 15579it [00:25, 548.39it/s]Reading dataset: 15643it [00:25, 572.37it/s]Reading dataset: 15711it [00:25, 602.17it/s]Reading dataset: 15772it [00:25, 543.16it/s]Reading dataset: 15843it [00:25, 587.72it/s]Reading dataset: 15909it [00:25, 607.09it/s]Reading dataset: 15971it [00:26, 513.54it/s]Reading dataset: 16026it [00:26, 509.00it/s]Reading dataset: 16091it [00:26, 535.01it/s]Reading dataset: 16195it [00:26, 669.40it/s]Reading dataset: 16271it [00:26, 690.06it/s]Reading dataset: 16348it [00:26, 709.40it/s]Reading dataset: 16423it [00:26, 718.97it/s]Reading dataset: 16497it [00:26, 656.99it/s]Reading dataset: 16565it [00:27, 648.99it/s]