Using device: cuda
Logs will be stored in /home/polyu/pcllzy/zo_withbp/logs/exp2_bp2_zo64_shared_20251110_004848
成功从本地加载tokenizer: /home/polyu/pcllzy/zo_withbp/tokenizer
Creating model: 200M
Description: 中小型模型，约200M参数，类似GPT-2 Small
Configuration:
  - Embedding dim: 768
  - Layers: 12
  - Attention heads: 12
  - Max position: 1024
  - Vocab size: 50258

Model created successfully!
Total parameters: 124,440,576 (124.44M)
Trainable parameters: 124,440,576 (124.44M)
Loading dataset: dclm-pubmedqa-merged
Description: DCLM和PubMedQA合并数据集，共20,000条，已统一为text字段
Loading local dataset from: /home/polyu/pcllzy/zo_withbp/datasets_subset/dclm_pubmedqa_merged
Tokenizing dataset...
Reading dataset:   0%|          | 0/20000 [00:00<?, ?it/s]Reading dataset:   0%|          | 87/20000 [00:00<00:23, 863.57it/s]Reading dataset:   1%|          | 174/20000 [00:00<00:29, 677.22it/s]Reading dataset:   1%|          | 245/20000 [00:00<00:29, 670.36it/s]Reading dataset:   2%|▏         | 328/20000 [00:00<00:27, 721.60it/s]Reading dataset:   2%|▏         | 402/20000 [00:00<00:30, 645.40it/s]Reading dataset:   2%|▏         | 469/20000 [00:00<00:31, 616.14it/s]Reading dataset:   3%|▎         | 541/20000 [00:00<00:31, 622.06it/s]Reading dataset:   3%|▎         | 622/20000 [00:00<00:28, 675.15it/s]Reading dataset:   3%|▎         | 693/20000 [00:01<00:28, 684.07it/s]Reading dataset:   4%|▍         | 763/20000 [00:01<00:30, 638.04it/s]Reading dataset:   4%|▍         | 830/20000 [00:01<00:29, 643.24it/s]Reading dataset:   5%|▍         | 915/20000 [00:01<00:27, 698.37it/s]Reading dataset:   5%|▍         | 994/20000 [00:01<00:26, 724.10it/s]Reading dataset:   5%|▌         | 1068/20000 [00:01<00:30, 623.79it/s]Reading dataset:   6%|▌         | 1134/20000 [00:01<00:30, 611.29it/s]Reading dataset:   6%|▌         | 1198/20000 [00:01<00:31, 599.73it/s]Reading dataset:   6%|▋         | 1272/20000 [00:01<00:30, 619.43it/s]Reading dataset:   7%|▋         | 1335/20000 [00:02<00:33, 559.97it/s]Reading dataset:   7%|▋         | 1427/20000 [00:02<00:28, 650.80it/s]Reading dataset:   8%|▊         | 1514/20000 [00:02<00:26, 705.11it/s]Reading dataset:   8%|▊         | 1587/20000 [00:02<00:27, 674.75it/s]Reading dataset:   8%|▊         | 1657/20000 [00:02<00:26, 681.38it/s]Reading dataset:   9%|▊         | 1727/20000 [00:02<00:27, 667.07it/s]Reading dataset:   9%|▉         | 1827/20000 [00:02<00:24, 743.24it/s]Reading dataset:  10%|▉         | 1903/20000 [00:02<00:26, 672.36it/s]Reading dataset:  10%|▉         | 1973/20000 [00:02<00:26, 675.25it/s]Reading dataset:  10%|█         | 2051/20000 [00:03<00:25, 703.65it/s]Reading dataset:  11%|█         | 2124/20000 [00:03<00:25, 710.28it/s]Reading dataset:  11%|█         | 2198/20000 [00:03<00:24, 718.74it/s]Reading dataset:  11%|█▏        | 2271/20000 [00:03<00:26, 665.73it/s]Reading dataset:  12%|█▏        | 2339/20000 [00:03<00:26, 662.45it/s]Reading dataset:  12%|█▏        | 2407/20000 [00:03<00:26, 655.89it/s]Reading dataset:  12%|█▏        | 2474/20000 [00:03<00:27, 642.03it/s]Reading dataset:  13%|█▎        | 2539/20000 [00:03<00:29, 599.63it/s]Reading dataset:  13%|█▎        | 2613/20000 [00:03<00:27, 634.30it/s]Reading dataset:  13%|█▎        | 2678/20000 [00:04<00:29, 595.56it/s]Reading dataset:  14%|█▍        | 2755/20000 [00:04<00:27, 635.78it/s]Reading dataset:  14%|█▍        | 2825/20000 [00:04<00:26, 645.33it/s]Reading dataset:  14%|█▍        | 2891/20000 [00:04<00:26, 637.96it/s]Reading dataset:  15%|█▍        | 2960/20000 [00:04<00:26, 633.59it/s]Reading dataset:  15%|█▌        | 3024/20000 [00:04<00:28, 604.97it/s]Reading dataset:  16%|█▌        | 3119/20000 [00:04<00:24, 699.87it/s]Reading dataset:  16%|█▌        | 3191/20000 [00:04<00:24, 688.69it/s]Reading dataset:  16%|█▋        | 3261/20000 [00:04<00:25, 658.09it/s]Reading dataset:  17%|█▋        | 3333/20000 [00:05<00:24, 675.04it/s]Reading dataset:  17%|█▋        | 3407/20000 [00:05<00:23, 691.89it/s]Reading dataset:  17%|█▋        | 3477/20000 [00:05<00:25, 639.03it/s]Reading dataset:  18%|█▊        | 3558/20000 [00:05<00:23, 685.56it/s]Reading dataset:  18%|█▊        | 3652/20000 [00:05<00:21, 754.01it/s]Reading dataset:  19%|█▊        | 3729/20000 [00:05<00:26, 607.13it/s]Reading dataset:  19%|█▉        | 3795/20000 [00:05<00:27, 580.88it/s]Reading dataset:  19%|█▉        | 3857/20000 [00:05<00:28, 573.15it/s]Reading dataset:  20%|█▉        | 3917/20000 [00:06<00:27, 576.43it/s]Reading dataset:  20%|█▉        | 3991/20000 [00:06<00:26, 607.09it/s]Reading dataset:  20%|██        | 4054/20000 [00:06<00:27, 576.87it/s]Reading dataset:  21%|██        | 4147/20000 [00:06<00:23, 670.85it/s]Reading dataset:  21%|██        | 4217/20000 [00:06<00:24, 655.29it/s]Reading dataset:  21%|██▏       | 4295/20000 [00:06<00:22, 688.85it/s]Reading dataset:  22%|██▏       | 4366/20000 [00:06<00:23, 663.72it/s]Reading dataset:  22%|██▏       | 4434/20000 [00:06<00:25, 618.87it/s]Reading dataset:  23%|██▎       | 4519/20000 [00:06<00:22, 676.74it/s]Reading dataset:  23%|██▎       | 4589/20000 [00:07<00:26, 580.12it/s]Reading dataset:  23%|██▎       | 4651/20000 [00:07<00:26, 579.69it/s]Reading dataset:  24%|██▎       | 4712/20000 [00:07<00:27, 546.01it/s]Reading dataset:  24%|██▍       | 4776/20000 [00:07<00:26, 567.94it/s]Reading dataset:  24%|██▍       | 4851/20000 [00:07<00:24, 616.34it/s]Reading dataset:  25%|██▍       | 4915/20000 [00:07<00:24, 621.04it/s]Reading dataset:  25%|██▍       | 4979/20000 [00:07<00:24, 623.02it/s]Reading dataset:  25%|██▌       | 5043/20000 [00:07<00:25, 597.32it/s]Reading dataset:  26%|██▌       | 5104/20000 [00:07<00:25, 586.33it/s]Reading dataset:  26%|██▌       | 5176/20000 [00:08<00:23, 623.44it/s]Reading dataset:  26%|██▌       | 5239/20000 [00:08<00:35, 421.54it/s]Reading dataset:  26%|██▋       | 5299/20000 [00:08<00:32, 454.04it/s]Reading dataset:  27%|██▋       | 5352/20000 [00:08<00:40, 365.13it/s]Reading dataset:  27%|██▋       | 5437/20000 [00:08<00:31, 456.31it/s]Reading dataset:  27%|██▋       | 5492/20000 [00:08<00:40, 361.81it/s]Reading dataset:  28%|██▊       | 5574/20000 [00:09<00:32, 445.24it/s]Reading dataset:  28%|██▊       | 5659/20000 [00:09<00:27, 528.52it/s]Reading dataset:  29%|██▊       | 5722/20000 [00:09<00:27, 523.10it/s]Reading dataset:  29%|██▉       | 5782/20000 [00:09<00:27, 522.74it/s]Reading dataset:  29%|██▉       | 5864/20000 [00:09<00:23, 592.62it/s]Reading dataset:  30%|██▉       | 5952/20000 [00:09<00:21, 667.27it/s]Reading dataset:  30%|███       | 6024/20000 [00:09<00:20, 681.05it/s]Reading dataset:  30%|███       | 6096/20000 [00:09<00:21, 652.42it/s]Reading dataset:  31%|███       | 6186/20000 [00:09<00:19, 712.81it/s]Reading dataset:  31%|███▏      | 6266/20000 [00:10<00:18, 731.13it/s]Reading dataset:  32%|███▏      | 6341/20000 [00:10<00:19, 697.28it/s]Reading dataset:  32%|███▏      | 6413/20000 [00:10<00:19, 689.91it/s]Reading dataset:  32%|███▏      | 6483/20000 [00:10<00:20, 647.41it/s]Reading dataset:  33%|███▎      | 6549/20000 [00:10<00:24, 558.33it/s]Reading dataset:  33%|███▎      | 6608/20000 [00:10<00:24, 555.31it/s]Reading dataset:  33%|███▎      | 6669/20000 [00:10<00:23, 568.99it/s]Reading dataset:  34%|███▎      | 6728/20000 [00:10<00:26, 500.09it/s]Reading dataset:  34%|███▍      | 6785/20000 [00:11<00:25, 517.12it/s]Reading dataset:  34%|███▍      | 6867/20000 [00:11<00:22, 573.19it/s]Reading dataset:  35%|███▍      | 6943/20000 [00:11<00:21, 617.44it/s]Reading dataset:  35%|███▌      | 7007/20000 [00:11<00:21, 600.06it/s]Reading dataset:  35%|███▌      | 7092/20000 [00:11<00:19, 668.33it/s]Reading dataset:  36%|███▌      | 7169/20000 [00:11<00:18, 681.32it/s]Reading dataset:  36%|███▋      | 7251/20000 [00:11<00:17, 711.83it/s]Reading dataset:  37%|███▋      | 7323/20000 [00:11<00:23, 539.82it/s]Reading dataset:  37%|███▋      | 7384/20000 [00:12<00:23, 546.91it/s]Reading dataset:  37%|███▋      | 7459/20000 [00:12<00:21, 591.51it/s]Reading dataset:  38%|███▊      | 7529/20000 [00:12<00:20, 618.31it/s]Reading dataset:  38%|███▊      | 7595/20000 [00:12<00:25, 481.14it/s]Reading dataset:  38%|███▊      | 7651/20000 [00:12<00:24, 496.76it/s]Reading dataset:  39%|███▊      | 7710/20000 [00:12<00:23, 518.92it/s]Reading dataset:  39%|███▉      | 7808/20000 [00:12<00:19, 637.33it/s]Reading dataset:  39%|███▉      | 7877/20000 [00:12<00:19, 617.78it/s]Reading dataset:  40%|███▉      | 7943/20000 [00:12<00:20, 587.39it/s]Reading dataset:  40%|████      | 8005/20000 [00:13<00:20, 574.42it/s]Reading dataset:  40%|████      | 8071/20000 [00:13<00:20, 586.40it/s]Reading dataset:  41%|████      | 8131/20000 [00:13<00:20, 584.97it/s]Reading dataset:  41%|████      | 8191/20000 [00:13<00:20, 579.00it/s]Reading dataset:  41%|████▏     | 8273/20000 [00:13<00:18, 646.52it/s]Reading dataset:  42%|████▏     | 8354/20000 [00:13<00:16, 691.97it/s]Reading dataset:  42%|████▏     | 8425/20000 [00:13<00:17, 674.80it/s]Reading dataset:  43%|████▎     | 8517/20000 [00:13<00:15, 744.22it/s]Reading dataset:  43%|████▎     | 8593/20000 [00:13<00:15, 731.32it/s]Reading dataset:  43%|████▎     | 8680/20000 [00:14<00:14, 767.87it/s]Reading dataset:  44%|████▍     | 8758/20000 [00:14<00:15, 749.41it/s]Reading dataset:  44%|████▍     | 8834/20000 [00:14<00:15, 739.85it/s]Reading dataset:  45%|████▍     | 8919/20000 [00:14<00:14, 767.51it/s]Reading dataset:  45%|████▍     | 8997/20000 [00:14<00:15, 730.96it/s]Reading dataset:  45%|████▌     | 9071/20000 [00:14<00:17, 639.64it/s]Reading dataset:  46%|████▌     | 9140/20000 [00:14<00:16, 650.51it/s]Reading dataset:  46%|████▌     | 9207/20000 [00:14<00:17, 616.93it/s]Reading dataset:  46%|████▋     | 9286/20000 [00:14<00:16, 659.72it/s]Reading dataset:  47%|████▋     | 9354/20000 [00:15<00:17, 614.55it/s]Reading dataset:  47%|████▋     | 9434/20000 [00:15<00:15, 661.52it/s]Reading dataset:  48%|████▊     | 9525/20000 [00:15<00:14, 728.29it/s]Reading dataset:  48%|████▊     | 9600/20000 [00:15<00:19, 530.83it/s]Reading dataset:  48%|████▊     | 9694/20000 [00:15<00:16, 622.90it/s]Reading dataset:  49%|████▉     | 9766/20000 [00:15<00:17, 595.17it/s]Reading dataset:  49%|████▉     | 9832/20000 [00:15<00:17, 588.21it/s]Reading dataset:  50%|████▉     | 9919/20000 [00:15<00:16, 625.91it/s]Reading dataset:  50%|████▉     | 9994/20000 [00:16<00:15, 629.63it/s]Reading dataset:  50%|█████     | 10072/20000 [00:16<00:15, 639.01it/s]Reading dataset:  51%|█████     | 10138/20000 [00:16<00:15, 624.81it/s]Reading dataset:  51%|█████     | 10202/20000 [00:16<00:16, 589.70it/s]Reading dataset:  52%|█████▏    | 10303/20000 [00:16<00:14, 690.37it/s]Reading dataset:  52%|█████▏    | 10386/20000 [00:16<00:13, 724.18it/s]Reading dataset:  52%|█████▏    | 10474/20000 [00:16<00:12, 766.04it/s]Reading dataset:  53%|█████▎    | 10552/20000 [00:17<00:16, 570.44it/s]Reading dataset:  53%|█████▎    | 10618/20000 [00:17<00:16, 557.57it/s]Reading dataset:  53%|█████▎    | 10687/20000 [00:17<00:15, 583.84it/s]Reading dataset:  54%|█████▍    | 10750/20000 [00:17<00:16, 566.55it/s]Reading dataset:  54%|█████▍    | 10810/20000 [00:17<00:22, 410.91it/s]Reading dataset:  54%|█████▍    | 10862/20000 [00:17<00:21, 431.87it/s]Reading dataset:  55%|█████▍    | 10940/20000 [00:17<00:18, 499.24it/s]Reading dataset:  55%|█████▍    | 10996/20000 [00:17<00:17, 503.58it/s]Reading dataset:  55%|█████▌    | 11051/20000 [00:18<00:17, 512.87it/s]Reading dataset:  56%|█████▌    | 11111/20000 [00:18<00:16, 525.14it/s]Reading dataset:  56%|█████▌    | 11170/20000 [00:18<00:16, 541.64it/s]Reading dataset:  56%|█████▌    | 11227/20000 [00:18<00:16, 545.05it/s]Reading dataset:  56%|█████▋    | 11288/20000 [00:18<00:15, 549.27it/s]Reading dataset:  57%|█████▋    | 11352/20000 [00:18<00:15, 574.05it/s]Reading dataset:  57%|█████▋    | 11437/20000 [00:18<00:13, 651.31it/s]Reading dataset:  58%|█████▊    | 11522/20000 [00:18<00:12, 705.69it/s]Reading dataset:  58%|█████▊    | 11605/20000 [00:18<00:11, 738.11it/s]Reading dataset:  58%|█████▊    | 11680/20000 [00:18<00:11, 730.10it/s]Reading dataset:  59%|█████▉    | 11769/20000 [00:19<00:10, 763.98it/s]Reading dataset:  59%|█████▉    | 11849/20000 [00:19<00:10, 768.72it/s]Reading dataset:  60%|█████▉    | 11927/20000 [00:19<00:11, 719.36it/s]Reading dataset:  60%|██████    | 12026/20000 [00:19<00:10, 791.15it/s]Reading dataset:  61%|██████    | 12110/20000 [00:19<00:09, 804.99it/s]Reading dataset:  61%|██████    | 12192/20000 [00:19<00:10, 710.50it/s]Reading dataset:  61%|██████▏   | 12284/20000 [00:19<00:10, 765.47it/s]Reading dataset:  62%|██████▏   | 12363/20000 [00:19<00:10, 714.94it/s]Reading dataset:  62%|██████▏   | 12443/20000 [00:19<00:10, 703.24it/s]Reading dataset:  63%|██████▎   | 12515/20000 [00:20<00:11, 662.71it/s]Reading dataset:  63%|██████▎   | 12583/20000 [00:20<00:11, 652.48it/s]Reading dataset:  63%|██████▎   | 12656/20000 [00:20<00:10, 669.99it/s]Reading dataset:  64%|██████▎   | 12739/20000 [00:20<00:10, 712.42it/s]Reading dataset:  64%|██████▍   | 12812/20000 [00:20<00:10, 712.76it/s]Reading dataset:  64%|██████▍   | 12884/20000 [00:20<00:10, 685.93it/s]Reading dataset:  65%|██████▍   | 12978/20000 [00:20<00:09, 740.31it/s]Reading dataset:  65%|██████▌   | 13078/20000 [00:20<00:08, 812.84it/s]Reading dataset:  66%|██████▌   | 13161/20000 [00:21<00:09, 696.89it/s]Reading dataset:  66%|██████▌   | 13243/20000 [00:21<00:09, 728.71it/s]Reading dataset:  67%|██████▋   | 13332/20000 [00:21<00:08, 765.38it/s]Reading dataset:  67%|██████▋   | 13411/20000 [00:21<00:09, 692.20it/s]Reading dataset:  67%|██████▋   | 13483/20000 [00:21<00:09, 691.52it/s]Reading dataset:  68%|██████▊   | 13601/20000 [00:21<00:07, 818.37it/s]Reading dataset:  68%|██████▊   | 13686/20000 [00:21<00:07, 824.80it/s]Reading dataset:  69%|██████▉   | 13771/20000 [00:21<00:09, 675.24it/s]Reading dataset:  69%|██████▉   | 13854/20000 [00:21<00:08, 713.37it/s]Reading dataset:  70%|██████▉   | 13930/20000 [00:22<00:09, 668.83it/s]Reading dataset:  70%|███████   | 14014/20000 [00:22<00:08, 708.18it/s]Reading dataset:  70%|███████   | 14088/20000 [00:22<00:08, 674.48it/s]Reading dataset:  71%|███████   | 14158/20000 [00:22<00:08, 675.71it/s]Reading dataset:  71%|███████   | 14228/20000 [00:22<00:09, 587.71it/s]Reading dataset:  72%|███████▏  | 14307/20000 [00:22<00:09, 628.34it/s]Reading dataset:  72%|███████▏  | 14380/20000 [00:22<00:08, 654.46it/s]Reading dataset:  72%|███████▏  | 14448/20000 [00:22<00:09, 607.88it/s]Reading dataset:  73%|███████▎  | 14524/20000 [00:23<00:08, 644.98it/s]Reading dataset:  73%|███████▎  | 14591/20000 [00:23<00:08, 621.16it/s]Reading dataset:  73%|███████▎  | 14670/20000 [00:23<00:08, 632.94it/s]Reading dataset:  74%|███████▎  | 14735/20000 [00:23<00:08, 633.98it/s]Reading dataset:  74%|███████▍  | 14802/20000 [00:23<00:08, 640.93it/s]Reading dataset:  74%|███████▍  | 14881/20000 [00:23<00:07, 677.94it/s]Reading dataset:  75%|███████▍  | 14950/20000 [00:23<00:07, 647.81it/s]Reading dataset:  75%|███████▌  | 15016/20000 [00:23<00:08, 588.40it/s]Reading dataset:  75%|███████▌  | 15079/20000 [00:23<00:08, 592.36it/s]Reading dataset:  76%|███████▌  | 15141/20000 [00:24<00:08, 595.83it/s]Reading dataset:  76%|███████▌  | 15214/20000 [00:24<00:07, 626.24it/s]Reading dataset:  76%|███████▋  | 15283/20000 [00:24<00:07, 644.14it/s]Reading dataset:  77%|███████▋  | 15348/20000 [00:24<00:08, 556.12it/s]Reading dataset:  77%|███████▋  | 15430/20000 [00:24<00:07, 608.45it/s]Reading dataset:  78%|███████▊  | 15502/20000 [00:24<00:07, 636.68it/s]Reading dataset:  78%|███████▊  | 15568/20000 [00:24<00:07, 568.67it/s]Reading dataset:  78%|███████▊  | 15640/20000 [00:24<00:07, 603.83it/s]Reading dataset:  79%|███████▊  | 15704/20000 [00:24<00:07, 613.50it/s]Reading dataset:  79%|███████▉  | 15767/20000 [00:25<00:07, 560.94it/s]Reading dataset:  79%|███████▉  | 15842/20000 [00:25<00:06, 610.61it/s]Reading dataset:  80%|███████▉  | 15910/20000 [00:25<00:06, 625.42it/s]Reading dataset:  80%|███████▉  | 15975/20000 [00:25<00:07, 536.36it/s]Reading dataset:  80%|████████  | 16032/20000 [00:25<00:07, 533.20it/s]Reading dataset:  80%|████████  | 16091/20000 [00:25<00:07, 544.58it/s]Reading dataset:  81%|████████  | 16196/20000 [00:25<00:05, 679.31it/s]Reading dataset:  81%|████████▏ | 16272/20000 [00:25<00:05, 696.30it/s]Reading dataset:  82%|████████▏ | 16356/20000 [00:25<00:04, 736.01it/s]Reading dataset:  82%|████████▏ | 16432/20000 [00:26<00:05, 654.80it/s]Reading dataset:  83%|████████▎ | 16515/20000 [00:26<00:04, 700.71it/s]Reading dataset:  83%|████████▎ | 16588/20000 [00:26<00:06, 507.19it/s]Reading dataset:  83%|████████▎ | 16648/20000 [00:26<00:06, 516.10it/s]Reading dataset:  84%|████████▎ | 16717/20000 [00:26<00:05, 554.59it/s]Reading dataset:  84%|████████▍ | 16781/20000 [00:26<00:05, 573.82it/s]Reading dataset:  84%|████████▍ | 16848/20000 [00:26<00:05, 590.78it/s]Reading dataset:  85%|████████▍ | 16925/20000 [00:26<00:04, 637.51it/s]Reading dataset:  85%|████████▍ | 16993/20000 [00:27<00:04, 624.61it/s]Reading dataset:  85%|████████▌ | 17058/20000 [00:27<00:05, 576.08it/s]Reading dataset:  86%|████████▌ | 17122/20000 [00:27<00:04, 591.28it/s]Reading dataset:  86%|████████▌ | 17192/20000 [00:27<00:04, 576.02it/s]Reading dataset:  86%|████████▋ | 17259/20000 [00:27<00:04, 577.30it/s]Reading dataset:  87%|████████▋ | 17334/20000 [00:27<00:04, 623.47it/s]Reading dataset:  87%|████████▋ | 17407/20000 [00:27<00:03, 652.25it/s]Reading dataset:  87%|████████▋ | 17474/20000 [00:27<00:04, 616.28it/s]Reading dataset:  88%|████████▊ | 17537/20000 [00:28<00:04, 603.05it/s]Reading dataset:  88%|████████▊ | 17599/20000 [00:28<00:03, 601.70it/s]Reading dataset:  88%|████████▊ | 17700/20000 [00:28<00:03, 711.44it/s]Reading dataset:  89%|████████▉ | 17785/20000 [00:28<00:02, 750.41it/s]Reading dataset:  89%|████████▉ | 17861/20000 [00:28<00:03, 656.40it/s]Reading dataset:  90%|████████▉ | 17934/20000 [00:28<00:03, 675.65it/s]Reading dataset:  90%|█████████ | 18004/20000 [00:28<00:03, 613.51it/s]Reading dataset:  90%|█████████ | 18084/20000 [00:28<00:02, 658.15it/s]Reading dataset:  91%|█████████ | 18166/20000 [00:28<00:02, 693.15it/s]Reading dataset:  91%|█████████ | 18238/20000 [00:29<00:02, 660.52it/s]Reading dataset:  92%|█████████▏| 18306/20000 [00:29<00:02, 642.48it/s]Reading dataset:  92%|█████████▏| 18377/20000 [00:29<00:02, 647.90it/s]Reading dataset:  92%|█████████▏| 18443/20000 [00:29<00:02, 650.01it/s]Reading dataset:  93%|█████████▎| 18509/20000 [00:29<00:02, 607.15it/s]Reading dataset:  93%|█████████▎| 18605/20000 [00:29<00:01, 702.79it/s]Reading dataset:  93%|█████████▎| 18691/20000 [00:29<00:01, 746.42it/s]Reading dataset:  94%|█████████▍| 18769/20000 [00:29<00:01, 753.75it/s]Reading dataset:  94%|█████████▍| 18849/20000 [00:29<00:01, 765.95it/s]Reading dataset:  95%|█████████▍| 18927/20000 [00:29<00:01, 762.91it/s]Reading dataset:  95%|█████████▌| 19004/20000 [00:30<00:01, 719.59it/s]Reading dataset:  95%|█████████▌| 19077/20000 [00:30<00:01, 711.22it/s]Reading dataset:  96%|█████████▌| 19149/20000 [00:30<00:01, 699.21it/s]Reading dataset:  96%|█████████▌| 19220/20000 [00:30<00:01, 627.79it/s]Reading dataset:  96%|█████████▋| 19296/20000 [00:30<00:01, 661.85it/s]Reading dataset:  97%|█████████▋| 19383/20000 [00:30<00:00, 719.01it/s]Reading dataset:  97%|█████████▋| 19457/20000 [00:30<00:00, 686.10it/s]Reading dataset:  98%|█████████▊| 19527/20000 [00:30<00:00, 669.04it/s]Reading dataset:  98%|█████████▊| 19629/20000 [00:30<00:00, 765.91it/s]Reading dataset:  99%|█████████▊| 19708/20000 [00:31<00:00, 700.00it/s]Reading dataset:  99%|█████████▉| 19780/20000 [00:31<00:00, 530.12it/s]Reading dataset:  99%|█████████▉| 19856/20000 [00:31<00:00, 579.31it/s]Reading dataset: 100%|█████████▉| 19944/20000 [00:31<00:00, 651.69it/s]Reading dataset: 100%|██████████| 20000/20000 [00:31<00:00, 631.98it/s]
Creating blocks of size 128...
Dataset prepared. Total blocks: 108693
Saving dataset to cache: cache/dataset_dclm-pubmedqa-merged_bs128_samplesNone.pkl
BP batch size: 2 (different from training batch size: 1)
ZO query batch size: 2 (different from training batch size: 1)
Splitting dataset for BP and ZO (non-overlapping)...
Dataset split: BP subset = 54346 samples, ZO subset = 54347 samples
Creating BP dataloader from split subset, batch_size: 2
Training scope: full model.
Trainable parameters: 124.44M (100.00% of total)
ZO queries will share data across all directions (total 128 samples).
ZO queries will share 128 samples across all 64 directions.
BP will use separate dataset: None
Using optimizer: MuDaMW
Epoch 1/2:   0%|          | 0/108693 [00:00<?, ?it/s][Instruct] Summary: avg_rank=8388608.0, avg_cosine_similarity=0.927923, total_time=53.5994s
Epoch 1/2:   0%|          | 0/108693 [00:55<?, ?it/s, loss=10.9900, grad_norm=2130.9943, opt=mudamw, queries=64, bp_int=1]Epoch 1/2:   0%|          | 1/108693 [00:55<1681:57:55, 55.71s/it, loss=10.9900, grad_norm=2130.9943, opt=mudamw, queries=64, bp_int=1][Instruct] Summary: avg_rank=8388608.0, avg_cosine_similarity=0.930754, total_time=53.8680s
Epoch 1/2:   0%|          | 1/108693 [01:50<1681:57:55, 55.71s/it, loss=10.8034, grad_norm=1788.0582, opt=mudamw, queries=64, bp_int=1]Epoch 1/2:   0%|          | 2/108693 [01:50<1671:09:52, 55.35s/it, loss=10.8034, grad_norm=1788.0582, opt=mudamw, queries=64, bp_int=1][Instruct] Summary: avg_rank=8388608.0, avg_cosine_similarity=0.928154, total_time=54.0575s
Epoch 1/2:   0%|          | 2/108693 [02:46<1671:09:52, 55.35s/it, loss=10.4831, grad_norm=1171.7408, opt=mudamw, queries=64, bp_int=1]Epoch 1/2:   0%|          | 3/108693 [02:46<1670:10:50, 55.32s/it, loss=10.4831, grad_norm=1171.7408, opt=mudamw, queries=64, bp_int=1]