Using device: cuda
Logs will be stored in /home/polyu/pcllzy/zo_withbp/logs/test1_1b_bp_only_20251110_005206
成功从本地加载tokenizer: /home/polyu/pcllzy/zo_withbp/tokenizer
Creating model: 1B
Description: 大型模型，约1B参数，需要较大显存
Configuration:
  - Embedding dim: 1536
  - Layers: 24
  - Attention heads: 24
  - Max position: 1024
  - Vocab size: 50258

Model created successfully!
Total parameters: 758,728,704 (758.73M)
Trainable parameters: 758,728,704 (758.73M)
Loading dataset: dclm-pubmedqa-merged
Description: DCLM和PubMedQA合并数据集，共20,000条，已统一为text字段
Loading local dataset from: /home/polyu/pcllzy/zo_withbp/datasets_subset/dclm_pubmedqa_merged
Tokenizing dataset...
Reading dataset:   0%|          | 0/20 [00:00<?, ?it/s]Reading dataset: 87it [00:00, 835.76it/s]              Reading dataset: 171it [00:00, 659.18it/s]Reading dataset: 240it [00:00, 666.38it/s]Reading dataset: 324it [00:00, 711.58it/s]Reading dataset: 397it [00:00, 640.41it/s]Reading dataset: 463it [00:00, 623.73it/s]Reading dataset: 535it [00:00, 644.67it/s]Reading dataset: 601it [00:00, 644.57it/s]Reading dataset: 686it [00:01, 688.87it/s]Reading dataset: 756it [00:01, 646.62it/s]Reading dataset: 822it [00:01, 650.24it/s]Reading dataset: 911it [00:01, 713.42it/s]Reading dataset: 989it [00:01, 718.67it/s]Reading dataset: 1062it [00:01, 621.71it/s]Reading dataset: 1127it [00:01, 613.31it/s]Reading dataset: 1190it [00:01, 600.31it/s]Reading dataset: 1261it [00:01, 629.71it/s]Reading dataset: 1326it [00:02, 555.92it/s]Reading dataset: 1427it [00:02, 653.49it/s]Reading dataset: 1514it [00:02, 705.80it/s]Reading dataset: 1587it [00:02, 675.46it/s]Reading dataset: 1657it [00:02, 681.61it/s]Reading dataset: 1727it [00:02, 667.05it/s]Reading dataset: 1827it [00:02, 742.73it/s]Reading dataset: 1902it [00:02, 673.23it/s]Reading dataset: 1971it [00:02, 673.82it/s]Reading dataset: 2049it [00:03, 702.88it/s]Reading dataset: 2121it [00:03, 703.90it/s]Reading dataset: 2196it [00:03, 714.97it/s]Reading dataset: 2269it [00:03, 664.73it/s]Reading dataset: 2337it [00:03, 659.66it/s]Reading dataset: 2407it [00:03, 659.13it/s]Reading dataset: 2474it [00:03, 644.93it/s]Reading dataset: 2539it [00:03, 601.68it/s]Reading dataset: 2613it [00:03, 635.50it/s]Reading dataset: 2678it [00:04, 588.76it/s]Reading dataset: 2763it [00:04, 658.24it/s]Reading dataset: 2831it [00:04, 652.36it/s]Reading dataset: 2898it [00:04, 633.00it/s]Reading dataset: 2963it [00:04, 636.28it/s]Reading dataset: 3028it [00:04, 603.55it/s]Reading dataset: 3132it [00:04, 722.19it/s]Reading dataset: 3206it [00:04, 658.27it/s]Reading dataset: 3278it [00:04, 674.04it/s]Reading dataset: 3347it [00:05, 678.40it/s]Reading dataset: 3417it [00:05, 682.51it/s]Reading dataset: 3487it [00:05, 642.86it/s]Reading dataset: 3575it [00:05, 708.60it/s]Reading dataset: 3661it [00:05, 751.09it/s]Reading dataset: 3738it [00:05, 611.86it/s]Reading dataset: 3805it [00:05, 565.10it/s]Reading dataset: 3866it [00:05, 552.05it/s]Reading dataset: 3941it [00:06, 597.74it/s]Reading dataset: 4008it [00:06, 606.00it/s]Reading dataset: 4071it [00:06, 590.20it/s]Reading dataset: 4153it [00:06, 631.48it/s]Reading dataset: 4229it [00:06, 665.86it/s]Reading dataset: 4304it [00:06, 689.07it/s]Reading dataset: 4374it [00:06, 654.35it/s]Reading dataset: 4441it [00:06, 610.44it/s]Reading dataset: 4525it [00:06, 666.53it/s]Reading dataset: 4593it [00:07, 582.47it/s]Reading dataset: 4654it [00:07, 578.77it/s]Reading dataset: 4714it [00:07, 537.31it/s]Reading dataset: 4779it [00:07, 556.91it/s]Reading dataset: 4855it [00:07, 610.38it/s]Reading dataset: 4924it [00:07, 631.59it/s]Reading dataset: 4989it [00:07, 618.24it/s]Reading dataset: 5052it [00:07, 580.58it/s]Reading dataset: 5116it [00:07, 579.40it/s]Reading dataset: 5179it [00:08, 443.46it/s]Reading dataset: 5229it [00:08, 441.25it/s]Reading dataset: 5297it [00:08, 498.02it/s]Reading dataset: 5351it [00:08, 371.64it/s]Reading dataset: 5437it [00:08, 464.03it/s]Reading dataset: 5492it [00:09, 367.54it/s]Reading dataset: 5572it [00:09, 451.68it/s]Reading dataset: 5647it [00:09, 514.10it/s]Reading dataset: 5715it [00:09, 551.54it/s]Reading dataset: 5778it [00:09, 520.39it/s]Reading dataset: 5852it [00:09, 573.39it/s]Reading dataset: 5938it [00:09, 645.94it/s]Reading dataset: 6019it [00:09, 688.06it/s]Reading dataset: 6092it [00:09, 657.98it/s]Reading dataset: 6183it [00:09, 726.08it/s]Reading dataset: 6265it [00:10, 746.23it/s]Reading dataset: 6342it [00:10, 701.42it/s]Reading dataset: 6414it [00:10, 692.39it/s]Reading dataset: 6485it [00:10, 622.59it/s]Reading dataset: 6550it [00:10, 566.19it/s]Reading dataset: 6609it [00:10, 560.27it/s]Reading dataset: 6669it [00:10, 569.83it/s]Reading dataset: 6728it [00:10, 499.41it/s]Reading dataset: 6785it [00:11, 516.38it/s]Reading dataset: 6867it [00:11, 573.11it/s]Reading dataset: 6943it [00:11, 617.14it/s]Reading dataset: 7007it [00:11, 595.84it/s]Reading dataset: 7092it [00:11, 664.53it/s]Reading dataset: 7169it [00:11, 676.66it/s]Reading dataset: 7251it [00:11, 710.59it/s]Reading dataset: 7323it [00:11, 550.73it/s]Reading dataset: 7384it [00:12, 559.01it/s]Reading dataset: 7459it [00:12, 603.60it/s]Reading dataset: 7530it [00:12, 626.72it/s]Reading dataset: 7596it [00:12, 481.54it/s]Reading dataset: 7651it [00:12, 496.55it/s]Reading dataset: 7710it [00:12, 517.75it/s]Reading dataset: 7807it [00:12, 634.22it/s]Reading dataset: 7876it [00:12, 613.40it/s]Reading dataset: 7941it [00:12, 587.38it/s]Reading dataset: 8003it [00:13, 572.96it/s]Reading dataset: 8071it [00:13, 591.36it/s]Reading dataset: 8132it [00:13, 591.75it/s]Reading dataset: 8193it [00:13, 586.39it/s]Reading dataset: 8275it [00:13, 642.65it/s]Reading dataset: 8361it [00:13, 703.59it/s]Reading dataset: 8433it [00:13, 675.60it/s]Reading dataset: 8508it [00:13, 690.51it/s]Reading dataset: 8580it [00:13, 694.47it/s]Reading dataset: 8660it [00:14, 720.79it/s]Reading dataset: 8736it [00:14, 722.77it/s]Reading dataset: 8809it [00:14, 710.49it/s]Reading dataset: 8886it [00:14, 727.09it/s]Reading dataset: 8959it [00:14, 687.66it/s]Reading dataset: 9029it [00:14, 642.18it/s]Reading dataset: 9095it [00:14, 631.46it/s]Reading dataset: 9159it [00:14, 574.31it/s]Reading dataset: 9234it [00:14, 618.96it/s]Reading dataset: 9304it [00:15, 640.61it/s]Reading dataset: 9370it [00:15, 614.61it/s]Reading dataset: 9447it [00:15, 654.11it/s]Reading dataset: 9532it [00:15, 702.79it/s]Reading dataset: 9604it [00:15, 514.17it/s]Reading dataset: 9696it [00:15, 603.52it/s]Reading dataset: 9765it [00:15, 580.90it/s]Reading dataset: 9829it [00:15, 572.52it/s]Reading dataset: 9914it [00:16, 640.69it/s]Reading dataset: 9982it [00:16, 623.96it/s]Reading dataset: 10054it [00:16, 637.85it/s]Reading dataset: 10120it [00:16, 619.67it/s]Reading dataset: 10184it [00:16, 575.87it/s]Reading dataset: 10283it [00:16, 677.39it/s]Reading dataset: 10365it [00:16, 701.47it/s]Reading dataset: 10450it [00:16, 738.28it/s]Reading dataset: 10526it [00:17, 580.05it/s]Reading dataset: 10590it [00:17, 588.83it/s]Reading dataset: 10654it [00:17, 564.83it/s]Reading dataset: 10733it [00:17, 619.87it/s]Reading dataset: 10799it [00:17, 424.99it/s]Reading dataset: 10854it [00:17, 431.31it/s]Reading dataset: 10927it [00:17, 496.02it/s]Reading dataset: 10985it [00:17, 511.25it/s]Reading dataset: 11042it [00:18, 508.91it/s]Reading dataset: 11111it [00:18, 523.48it/s]Reading dataset: 11170it [00:18, 538.86it/s]Reading dataset: 11227it [00:18, 535.03it/s]Reading dataset: 11288it [00:18, 539.60it/s]Reading dataset: 11351it [00:18, 564.08it/s]Reading dataset: 11444it [00:18, 666.91it/s]Reading dataset: 11525it [00:18, 705.88it/s]Reading dataset: 11609it [00:18, 740.28it/s]Reading dataset: 11684it [00:19, 730.16it/s]Reading dataset: 11771it [00:19, 767.40it/s]Reading dataset: 11849it [00:19, 770.80it/s]Reading dataset: 11927it [00:19, 722.34it/s]Reading dataset: 12026it [00:19, 795.05it/s]Reading dataset: 12111it [00:19, 810.69it/s]Reading dataset: 12193it [00:19, 713.92it/s]Reading dataset: 12283it [00:19, 763.53it/s]Reading dataset: 12362it [00:19, 709.30it/s]Reading dataset: 12443it [00:20, 701.42it/s]Reading dataset: 12515it [00:20, 661.99it/s]Reading dataset: 12583it [00:20, 654.35it/s]Reading dataset: 12657it [00:20, 677.04it/s]Reading dataset: 12740it [00:20, 717.25it/s]Reading dataset: 12813it [00:20, 718.99it/s]Reading dataset: 12886it [00:20, 692.99it/s]Reading dataset: 12971it [00:20, 735.72it/s]Reading dataset: 13069it [00:20, 801.04it/s]Reading dataset: 13150it [00:21, 693.28it/s]Reading dataset: 13232it [00:21, 725.58it/s]Reading dataset: 13325it [00:21, 775.53it/s]Reading dataset: 13405it [00:21, 700.19it/s]Reading dataset: 13478it [00:21, 680.06it/s]Reading dataset: 13599it [00:21, 816.34it/s]Reading dataset: 13684it [00:21, 812.26it/s]Reading dataset: 13768it [00:21, 690.25it/s]Reading dataset: 13842it [00:22, 698.47it/s]Reading dataset: 13915it [00:22, 669.73it/s]Reading dataset: 13995it [00:22, 703.46it/s]Reading dataset: 14068it [00:22, 659.22it/s]Reading dataset: 14149it [00:22, 698.87it/s]Reading dataset: 14221it [00:22, 622.22it/s]Reading dataset: 14286it [00:22, 625.80it/s]Reading dataset: 14351it [00:22, 606.91it/s]Reading dataset: 14419it [00:22, 623.57it/s]Reading dataset: 14485it [00:23, 629.82it/s]Reading dataset: 14561it [00:23, 652.79it/s]Reading dataset: 14627it [00:23, 622.14it/s]Reading dataset: 14690it [00:23, 621.21it/s]Reading dataset: 14753it [00:23, 596.05it/s]Reading dataset: 14824it [00:23, 626.36it/s]Reading dataset: 14916it [00:23, 708.71it/s]Reading dataset: 14988it [00:23, 632.97it/s]Reading dataset: 15054it [00:23, 614.47it/s]Reading dataset: 15117it [00:24, 562.14it/s]Reading dataset: 15191it [00:24, 607.88it/s]Reading dataset: 15254it [00:24, 544.97it/s]Reading dataset: 15311it [00:24, 538.74it/s]Reading dataset: 15367it [00:24, 525.33it/s]Reading dataset: 15448it [00:24, 600.86it/s]Reading dataset: 15513it [00:24, 606.65it/s]Reading dataset: 15575it [00:24, 558.68it/s]Reading dataset: 15641it [00:25, 585.41it/s]Reading dataset: 15704it [00:25, 597.30it/s]Reading dataset: 15765it [00:25, 546.27it/s]Reading dataset: 15840it [00:25, 599.81it/s]Reading dataset: 15907it [00:25, 618.42it/s]Reading dataset: 15971it [00:25, 522.30it/s]Reading dataset: 16027it [00:25, 515.79it/s]Reading dataset: 16091it [00:25, 538.34it/s]Reading dataset: 16196it [00:25, 673.50it/s]Reading dataset: 16272it [00:26, 693.01it/s]Reading dataset: 16357it [00:26, 735.39it/s]Reading dataset: 16433it [00:26, 652.31it/s]Reading dataset: 16519it [00:26, 706.38it/s]Reading dataset: 16593it [00:26, 503.31it/s]Reading dataset: 16654it [00:26, 522.31it/s]Reading dataset: 16718it [00:26, 546.76it/s]Reading dataset: 16783it [00:26, 572.15it/s]Reading dataset: 16848it [00:27, 587.45it/s]Reading dataset: 16925it [00:27, 636.88it/s]