Using device: cuda
Logs will be stored in /home/polyu/pcllzy/zo_withbp/logs/test2_1b_zo_only_20251110_005206
成功从本地加载tokenizer: /home/polyu/pcllzy/zo_withbp/tokenizer
Creating model: 1B
Description: 大型模型，约1B参数，需要较大显存
Configuration:
  - Embedding dim: 1536
  - Layers: 24
  - Attention heads: 24
  - Max position: 1024
  - Vocab size: 50258

Model created successfully!
Total parameters: 758,728,704 (758.73M)
Trainable parameters: 758,728,704 (758.73M)
Loading dataset: dclm-pubmedqa-merged
Description: DCLM和PubMedQA合并数据集，共20,000条，已统一为text字段
Loading local dataset from: /home/polyu/pcllzy/zo_withbp/datasets_subset/dclm_pubmedqa_merged
Tokenizing dataset...
Reading dataset:   0%|          | 0/20 [00:00<?, ?it/s]Reading dataset: 87it [00:00, 852.28it/s]              Reading dataset: 173it [00:00, 678.99it/s]Reading dataset: 244it [00:00, 673.21it/s]Reading dataset: 328it [00:00, 728.48it/s]Reading dataset: 403it [00:00, 646.92it/s]Reading dataset: 470it [00:00, 619.95it/s]Reading dataset: 541it [00:00, 623.55it/s]Reading dataset: 625it [00:00, 684.86it/s]Reading dataset: 697it [00:01, 694.58it/s]Reading dataset: 768it [00:01, 657.56it/s]Reading dataset: 837it [00:01, 661.66it/s]Reading dataset: 927it [00:01, 728.42it/s]Reading dataset: 1001it [00:01, 723.21it/s]Reading dataset: 1074it [00:01, 618.05it/s]Reading dataset: 1139it [00:01, 593.73it/s]Reading dataset: 1201it [00:01, 576.89it/s]Reading dataset: 1264it [00:01, 583.26it/s]Reading dataset: 1324it [00:02, 506.35it/s]Reading dataset: 1426it [00:02, 630.17it/s]Reading dataset: 1505it [00:02, 662.26it/s]Reading dataset: 1575it [00:02, 627.21it/s]Reading dataset: 1651it [00:02, 661.67it/s]Reading dataset: 1720it [00:02, 631.18it/s]Reading dataset: 1806it [00:02, 692.56it/s]Reading dataset: 1879it [00:02, 681.16it/s]Reading dataset: 1949it [00:03, 621.62it/s]Reading dataset: 2013it [00:03, 605.55it/s]Reading dataset: 2098it [00:03, 668.16it/s]Reading dataset: 2167it [00:03, 632.23it/s]Reading dataset: 2234it [00:03, 640.20it/s]Reading dataset: 2299it [00:03, 641.77it/s]Reading dataset: 2364it [00:03, 615.10it/s]Reading dataset: 2427it [00:03, 580.10it/s]Reading dataset: 2490it [00:03, 548.73it/s]Reading dataset: 2556it [00:04, 576.19it/s]Reading dataset: 2626it [00:04, 609.89it/s]Reading dataset: 2688it [00:04, 557.41it/s]Reading dataset: 2774it [00:04, 638.09it/s]Reading dataset: 2840it [00:04, 616.63it/s]Reading dataset: 2904it [00:04, 615.87it/s]Reading dataset: 2968it [00:04, 618.50it/s]Reading dataset: 3031it [00:04, 587.30it/s]Reading dataset: 3132it [00:04, 699.88it/s]Reading dataset: 3204it [00:05, 660.49it/s]Reading dataset: 3272it [00:05, 651.15it/s]Reading dataset: 3342it [00:05, 664.47it/s]Reading dataset: 3412it [00:05, 666.62it/s]Reading dataset: 3480it [00:05, 633.48it/s]Reading dataset: 3558it [00:05, 673.78it/s]Reading dataset: 3647it [00:05, 732.89it/s]Reading dataset: 3722it [00:05, 587.14it/s]Reading dataset: 3786it [00:06, 552.32it/s]Reading dataset: 3845it [00:06, 548.88it/s]Reading dataset: 3916it [00:06, 581.11it/s]Reading dataset: 3991it [00:06, 614.81it/s]Reading dataset: 4055it [00:06, 585.55it/s]Reading dataset: 4151it [00:06, 684.07it/s]Reading dataset: 4222it [00:06, 655.15it/s]Reading dataset: 4297it [00:06, 674.19it/s]Reading dataset: 4366it [00:06, 660.19it/s]Reading dataset: 4433it [00:07, 605.24it/s]Reading dataset: 4517it [00:07, 667.28it/s]Reading dataset: 4586it [00:07, 578.59it/s]Reading dataset: 4647it [00:07, 551.40it/s]Reading dataset: 4705it [00:07, 530.44it/s]Reading dataset: 4760it [00:07, 531.56it/s]Reading dataset: 4830it [00:07, 567.12it/s]Reading dataset: 4889it [00:07, 572.30it/s]Reading dataset: 4958it [00:07, 591.07it/s]Reading dataset: 5018it [00:08, 564.24it/s]Reading dataset: 5081it [00:08, 579.78it/s]Reading dataset: 5147it [00:08, 598.55it/s]Reading dataset: 5208it [00:08, 405.97it/s]Reading dataset: 5258it [00:08, 411.42it/s]Reading dataset: 5306it [00:08, 413.25it/s]Reading dataset: 5352it [00:08, 349.89it/s]Reading dataset: 5437it [00:09, 450.40it/s]Reading dataset: 5488it [00:09, 352.97it/s]Reading dataset: 5566it [00:09, 439.48it/s]Reading dataset: 5643it [00:09, 513.56it/s]Reading dataset: 5715it [00:09, 557.53it/s]Reading dataset: 5778it [00:09, 526.84it/s]Reading dataset: 5854it [00:09, 585.16it/s]Reading dataset: 5939it [00:09, 654.62it/s]Reading dataset: 6023it [00:10, 696.21it/s]Reading dataset: 6096it [00:10, 669.82it/s]Reading dataset: 6186it [00:10, 731.77it/s]Reading dataset: 6266it [00:10, 750.51it/s]Reading dataset: 6343it [00:10, 717.82it/s]Reading dataset: 6417it [00:10, 707.87it/s]Reading dataset: 6489it [00:10, 616.46it/s]Reading dataset: 6554it [00:10, 580.66it/s]Reading dataset: 6614it [00:10, 567.46it/s]Reading dataset: 6679it [00:11, 588.61it/s]Reading dataset: 6740it [00:11, 510.23it/s]Reading dataset: 6796it [00:11, 519.94it/s]Reading dataset: 6869it [00:11, 574.88it/s]Reading dataset: 6943it [00:11, 618.27it/s]Reading dataset: 7007it [00:11, 588.32it/s]Reading dataset: 7089it [00:11, 650.77it/s]Reading dataset: 7169it [00:11, 664.30it/s]Reading dataset: 7251it [00:11, 694.33it/s]Reading dataset: 7322it [00:12, 514.20it/s]Reading dataset: 7381it [00:12, 521.22it/s]Reading dataset: 7457it [00:12, 578.18it/s]Reading dataset: 7520it [00:12, 590.26it/s]Reading dataset: 7583it [00:12, 436.70it/s]Reading dataset: 7640it [00:12, 465.25it/s]Reading dataset: 7705it [00:12, 508.95it/s]Reading dataset: 7787it [00:13, 586.67it/s]Reading dataset: 7852it [00:13, 593.88it/s]Reading dataset: 7916it [00:13, 529.57it/s]Reading dataset: 7979it [00:13, 552.86it/s]Reading dataset: 8038it [00:13, 534.81it/s]Reading dataset: 8101it [00:13, 549.57it/s]Reading dataset: 8174it [00:13, 592.29it/s]Reading dataset: 8236it [00:13, 598.28it/s]Reading dataset: 8327it [00:13, 685.97it/s]Reading dataset: 8397it [00:14, 679.58it/s]Reading dataset: 8478it [00:14, 714.89it/s]Reading dataset: 8571it [00:14, 776.46it/s]Reading dataset: 8653it [00:14, 787.79it/s]Reading dataset: 8736it [00:14, 766.35it/s]Reading dataset: 8814it [00:14, 742.25it/s]Reading dataset: 8915it [00:14, 813.83it/s]Reading dataset: 8998it [00:14, 741.42it/s]Reading dataset: 9074it [00:14, 651.66it/s]Reading dataset: 9142it [00:15, 649.51it/s]Reading dataset: 9209it [00:15, 631.42it/s]Reading dataset: 9286it [00:15, 667.59it/s]Reading dataset: 9355it [00:15, 621.00it/s]Reading dataset: 9436it [00:15, 670.92it/s]Reading dataset: 9525it [00:15, 729.99it/s]Reading dataset: 9600it [00:15, 513.63it/s]Reading dataset: 9695it [00:16, 606.66it/s]Reading dataset: 9766it [00:16, 577.37it/s]Reading dataset: 9831it [00:16, 570.38it/s]Reading dataset: 9915it [00:16, 636.41it/s]Reading dataset: 9984it [00:16, 618.16it/s]Reading dataset: 10054it [00:16, 622.67it/s]Reading dataset: 10119it [00:16, 600.18it/s]Reading dataset: 10181it [00:16, 557.87it/s]Reading dataset: 10279it [00:16, 667.10it/s]Reading dataset: 10356it [00:17, 688.25it/s]Reading dataset: 10439it [00:17, 717.87it/s]Reading dataset: 10513it [00:17, 640.50it/s]Reading dataset: 10580it [00:17, 551.30it/s]Reading dataset: 10639it [00:17, 522.23it/s]Reading dataset: 10703it [00:17, 550.23it/s]Reading dataset: 10761it [00:17, 530.93it/s]Reading dataset: 10816it [00:18, 366.87it/s]Reading dataset: 10863it [00:18, 382.36it/s]Reading dataset: 10940it [00:18, 457.01it/s]Reading dataset: 10995it [00:18, 460.28it/s]Reading dataset: 11046it [00:18, 462.81it/s]Reading dataset: 11111it [00:18, 488.43it/s]Reading dataset: 11170it [00:18, 508.51it/s]Reading dataset: 11227it [00:18, 516.00it/s]Reading dataset: 11288it [00:18, 520.63it/s]Reading dataset: 11350it [00:19, 545.83it/s]Reading dataset: 11437it [00:19, 634.43it/s]Reading dataset: 11519it [00:19, 686.17it/s]Reading dataset: 11605it [00:19, 717.29it/s]Reading dataset: 11678it [00:19, 705.58it/s]Reading dataset: 11768it [00:19, 755.05it/s]Reading dataset: 11844it [00:19, 745.97it/s]Reading dataset: 11919it [00:19, 676.41it/s]Reading dataset: 12012it [00:19, 745.08it/s]Reading dataset: 12098it [00:20, 774.18it/s]Reading dataset: 12177it [00:20, 727.01it/s]Reading dataset: 12252it [00:20, 703.77it/s]Reading dataset: 12324it [00:20, 683.24it/s]Reading dataset: 12400it [00:20, 703.89it/s]Reading dataset: 12472it [00:20, 664.62it/s]Reading dataset: 12540it [00:20, 631.30it/s]Reading dataset: 12617it [00:20, 661.38it/s]Reading dataset: 12684it [00:20, 652.96it/s]Reading dataset: 12773it [00:21, 718.67it/s]Reading dataset: 12846it [00:21, 706.64it/s]Reading dataset: 12918it [00:21, 705.47it/s]Reading dataset: 12997it [00:21, 728.33it/s]Reading dataset: 13088it [00:21, 778.61it/s]Reading dataset: 13167it [00:21, 674.49it/s]Reading dataset: 13258it [00:21, 736.57it/s]Reading dataset: 13335it [00:21, 745.30it/s]Reading dataset: 13412it [00:21, 668.96it/s]Reading dataset: 13482it [00:22, 665.61it/s]Reading dataset: 13551it [00:22, 632.51it/s]Reading dataset: 13622it [00:22, 641.18it/s]Reading dataset: 13724it [00:22, 726.47it/s]Reading dataset: 13798it [00:22, 617.81it/s]Reading dataset: 13872it [00:22, 644.38it/s]Reading dataset: 13940it [00:22, 621.60it/s]Reading dataset: 14016it [00:22, 657.67it/s]Reading dataset: 14084it [00:23, 611.72it/s]Reading dataset: 14152it [00:23, 616.96it/s]Reading dataset: 14215it [00:23, 560.33it/s]Reading dataset: 14286it [00:23, 576.90it/s]Reading dataset: 14345it [00:23, 567.52it/s]Reading dataset: 14415it [00:23, 601.36it/s]Reading dataset: 14478it [00:23, 603.61it/s]Reading dataset: 14559it [00:23, 660.02it/s]Reading dataset: 14626it [00:23, 615.07it/s]Reading dataset: 14689it [00:24, 617.09it/s]Reading dataset: 14752it [00:24, 592.62it/s]Reading dataset: 14823it [00:24, 624.34it/s]Reading dataset: 14916it [00:24, 708.96it/s]Reading dataset: 14988it [00:24, 634.29it/s]Reading dataset: 15054it [00:24, 612.91it/s]Reading dataset: 15117it [00:24, 559.28it/s]Reading dataset: 15190it [00:24, 602.49it/s]Reading dataset: 15271it [00:24, 656.74it/s]Reading dataset: 15339it [00:25, 553.17it/s]Reading dataset: 15430it [00:25, 606.51it/s]Reading dataset: 15502it [00:25, 634.13it/s]Reading dataset: 15568it [00:25, 568.64it/s]Reading dataset: 15638it [00:25, 600.04it/s]Reading dataset: 15701it [00:25, 599.22it/s]Reading dataset: 15763it [00:25, 552.15it/s]Reading dataset: 15831it [00:25, 585.12it/s]Reading dataset: 15905it [00:26, 623.05it/s]Reading dataset: 15969it [00:26, 536.70it/s]Reading dataset: 16026it [00:26, 514.04it/s]Reading dataset: 16091it [00:26, 535.46it/s]Reading dataset: 16195it [00:26, 666.47it/s]Reading dataset: 16271it [00:26, 685.33it/s]Reading dataset: 16348it [00:26, 705.73it/s]Reading dataset: 16423it [00:26, 713.16it/s]Reading dataset: 16496it [00:26, 647.95it/s]